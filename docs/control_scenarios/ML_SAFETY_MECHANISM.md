# ML ì˜ˆì¸¡ ì œì–´ ì•ˆì „ ë©”ì»¤ë‹ˆì¦˜

## ğŸ¯ ê°œìš”

ì´ ë¬¸ì„œëŠ” ESS AI Systemì—ì„œ ML ì˜ˆì¸¡ ì œì–´ê°€ ë¶ˆì•ˆì •í•  ë•Œ Rule ê¸°ë°˜ ì œì–´ê°€ ì–´ë–»ê²Œ ì‹œìŠ¤í…œì˜ ì•ˆì „ì„ ë³´ì¥í•˜ëŠ”ì§€ ì„¤ëª…í•©ë‹ˆë‹¤.

---

## ğŸ“‹ 3ë‹¨ê³„ ì•ˆì „ ì œì–´ ê³„ì¸µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Priority 1: Safety Layer (ìµœìš°ì„ )          â”‚ â† í•­ìƒ Rule ê¸°ë°˜!
â”‚  - S1: Cooler ê³¼ì—´ ë³´í˜¸                      â”‚
â”‚  - S2: FW ì…êµ¬ ì˜¨ë„ í•œê³„                     â”‚
â”‚  - S3: ì••ë ¥ ì•ˆì „ ì œì•½                        â”‚
â”‚  - S4: T5 ê·¹í•œ ì˜¨ë„ ì•ˆì „ ì œì–´                â”‚
â”‚  - S5: T6 ì˜¨ë„ ì œì–´                          â”‚
â”‚  - S6: T4 ê·¹í•œ ì˜¨ë„ ì•ˆì „ ì œì–´                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“ (safety_override=Trueë©´ ì—¬ê¸°ì„œ ì¢…ë£Œ)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Priority 2: ML Optimization (ì„ íƒì )        â”‚ â† ML ì‚¬ìš© ê°€ëŠ¥ ì‹œë§Œ!
â”‚  - ì˜¨ë„ ì˜ˆì¸¡ (Temperature Predictor)         â”‚
â”‚  - ìµœì  ì£¼íŒŒìˆ˜ ì¶”ì²œ (Random Forest)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Priority 3: Rule Fine-tuning               â”‚ â† Ruleë¡œ ë³´ì •!
â”‚  - R1: T5 ì˜¨ë„ ê¸°ë°˜ SW íŒí”„ ê°•í™” ë³´ì •       â”‚
â”‚  - R2: T4 ì˜¨ë„ ê¸°ë°˜ FW íŒí”„ ë³´ì •            â”‚
â”‚  - R4: ì—”ì§„ ë¶€í•˜ ê¸°ë°˜ ë³´ì •                   â”‚
â”‚  - R5: í•´ìˆ˜ ì˜¨ë„ ê¸°ë°˜ ë³´ì •                   â”‚
â”‚  - R6: íˆìŠ¤í…Œë¦¬ì‹œìŠ¤ (ë–¨ë¦¼ ë°©ì§€)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”’ í•µì‹¬ ì•ˆì „ ë©”ì»¤ë‹ˆì¦˜

### 1ï¸âƒ£ Safety Layerê°€ í•­ìƒ ìµœìš°ì„ 

```python
def compute_control(..., ml_prediction: Optional[Dict] = None):
    
    # ê¸°ë³¸ê°’: ML ì˜ˆì¸¡ ë˜ëŠ” ì´ì „ê°’ ì‚¬ìš©
    if ml_prediction:
        sw_freq = ml_prediction.get('sw_pump_freq', self.prev_sw_freq)
        # ML ê°’ì„ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©
    else:
        sw_freq = self.prev_sw_freq
        # ML ì—†ìœ¼ë©´ ì´ì „ê°’ ìœ ì§€
    
    # ===== Safety Layer (ìµœìš°ì„ !) =====
    safety_override = False
    
    # Rule S1: Cooler ê³¼ì—´ ë³´í˜¸
    if t2_t3_max >= 49.0:
        sw_freq = 60.0  # ê°•ì œ ìµœëŒ€!
        safety_override = True  # ML ë¬´ì‹œ!
        return RuleDecision(...)  # ì¦‰ì‹œ ì¢…ë£Œ!
    
    # Rule S2: FW ì…êµ¬ ì˜¨ë„ í•œê³„
    if t4_temp >= 48.0:
        fw_freq = 60.0  # ê°•ì œ ìµœëŒ€!
        safety_override = True
        return RuleDecision(...)  # ì¦‰ì‹œ ì¢…ë£Œ!
    
    # Rule S4: T5 ê·¹í•œ ì˜¨ë„ ì•ˆì „ ì œì–´
    if t5_temp > 40.0:
        sw_freq = 60.0  # ê·¹ê³ ì˜¨ â†’ ê°•ì œ 60Hz
        safety_override = True
        return RuleDecision(...)
    elif t5_temp < 30.0:
        sw_freq = 40.0  # ê·¹ì €ì˜¨ â†’ ê°•ì œ 40Hz
        safety_override = True
        return RuleDecision(...)
    
    # Rule S5: T6 ì˜¨ë„ ì œì–´
    if t6_temp > 45.0:
        er_freq = 60.0  # ê¸´ê¸‰ ê³ ì˜¨ â†’ 60Hz
        safety_override = True
        return RuleDecision(...)
    elif t6_temp > 44.0:
        er_freq = 60.0  # ê³ ì˜¨ â†’ 60Hz ìœ ì§€
        safety_override = True
        return RuleDecision(...)
    # ... (T6 ë‹¨ê³„ë³„ ì œì–´)
    
    # Rule S6: T4 ê·¹í•œ ì˜¨ë„ ì•ˆì „ ì œì–´ (3ë‹¨ê³„ ì—ë„ˆì§€ ì ˆê°)
    # Phase 1: T4 < 46Â°C â†’ 40Hz ê°•ì œ (ìµœëŒ€ ì—ë„ˆì§€ ì ˆê°)
    if t4_temp < 46.0 and t4_pred_5min < 48.0:
        fw_freq = 40.0
        safety_override = True
        return RuleDecision(...)
    # ... (T4 ë‹¨ê³„ë³„ ì œì–´)
    
    # safety_override=Trueë©´ ì—¬ê¸°ê¹Œì§€ ì˜¤ì§€ ì•ŠìŒ!
```

**í•µì‹¬ í¬ì¸íŠ¸:**
- `safety_override = True`ë¡œ ì„¤ì •ë˜ë©´ **ì¦‰ì‹œ return**
- ML ì˜ˆì¸¡ê°’ì€ ì™„ì „íˆ ë¬´ì‹œë¨
- Safety Layerë§Œìœ¼ë¡œë„ ì‹œìŠ¤í…œ ì•ˆì „ ë³´ì¥

---

### 2ï¸âƒ£ ML ì‹ ë¢°ë„ ê²€ì¦

```python
# IntegratedController._get_ml_prediction()
def _get_ml_prediction(self, temp_prediction):
    
    if not temp_prediction:
        return None  # ML ì˜ˆì¸¡ ì—†ìŒ â†’ Ruleë§Œ ì‚¬ìš©
    
    # ì‹ ë¢°ë„ ê²€ì¦!
    if temp_prediction.confidence < 0.5:  # 50% ë¯¸ë§Œì´ë©´
        return None  # ML ì‚¬ìš© ì•ˆ í•¨!
    
    # ì‹ ë¢°ë„ 50% ì´ìƒì¼ ë•Œë§Œ ML ì‚¬ìš©
    if temp_prediction.confidence > 0.5:
        # ML ì˜ˆì¸¡ ê¸°ë°˜ ì£¼íŒŒìˆ˜ ì¡°ì •
        if t5_delta > 0.5:
            sw_adj = 3.0  # ì„ ì œì  ì¦ì†
        # ...
```

**í•µì‹¬ í¬ì¸íŠ¸:**
- ML ì‹ ë¢°ë„ê°€ 50% ë¯¸ë§Œì´ë©´ **MLì„ ì•„ì˜ˆ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ**
- ì´ ê²½ìš° Rule ê¸°ë°˜ ì œì–´ë¡œë§Œ ì‘ë™
- ì‹ ë¢°ë„ê°€ ì¶©ë¶„í•´ì•¼ë§Œ MLì˜ ì„ ì œì  ì œì–´ í™œì„±í™”

---

### 3ï¸âƒ£ ML ì‹¤íŒ¨ ì‹œ Fallback

```python
# IntegratedController.compute_control()
try:
    # ML ì˜ˆì¸¡ ì‹œë„
    ml_prediction = self._get_ml_prediction(
        temp_prediction, engine_load, temperatures
    )
except Exception as e:
    print(f"[WARNING] ML ì˜ˆì¸¡ ì‹¤íŒ¨: {e}")
    ml_prediction = None  # ML ì‹¤íŒ¨ â†’ None

# Rule ê¸°ë°˜ ì œì–´ (MLì´ Noneì´ì–´ë„ ì •ìƒ ì‘ë™!)
decision = self.rule_controller.compute_control(
    temperatures=temperatures,
    pressures=pressures,
    engine_load=engine_load,
    seawater_temp=temperatures.get('T1', 25.0),
    current_frequencies={...},
    ml_prediction=ml_prediction  # Noneì´ì–´ë„ OK!
)
```

**í•µì‹¬ í¬ì¸íŠ¸:**
- ML ì˜ˆì¸¡ì´ ì‹¤íŒ¨í•˜ê±°ë‚˜ `None`ì´ë©´ ìë™ìœ¼ë¡œ Rule ê¸°ë°˜ ì œì–´ë¡œ ì „í™˜
- `ml_prediction=None`ì¼ ë•Œ Rule ê¸°ë°˜ ì œì–´ëŠ” ì´ì „ ì£¼íŒŒìˆ˜(`prev_freq`)ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì‘ë™
- ì‹œìŠ¤í…œì€ ML ì—†ì´ë„ ì™„ë²½íˆ ë™ì‘

---

### 4ï¸âƒ£ Dummy Model í•™ìŠµ (ì´ˆê¸° ì•ˆì •ì„±)

```python
# IntegratedController._train_dummy_model()
def _train_dummy_model(self):
    """ìµœì†Œ ë™ì‘ìš© ë”ë¯¸ ëª¨ë¸ í•™ìŠµ"""
    
    # 50ê°œì˜ ë‹¤ì–‘í•œ ë”ë¯¸ ë°ì´í„° ìƒì„±
    training_data = []
    for i in range(50):
        # ë‹¤ì–‘í•œ ì˜¨ë„ íŠ¸ë Œë“œ (ìƒìŠ¹/í•˜ê°•/ì•ˆì •)
        trend = np.random.choice([-1, 0, 1])
        
        # 90ê°œ ì‹œí€€ìŠ¤ ìƒì„± (30ë¶„ ë°ì´í„°)
        t4_seq = [base_t4 + trend * j/90 * 2 + noise for j in range(90)]
        # ...
        
        # ë”ë¯¸ íƒ€ê²Ÿ (í˜„ì¬ ê°’ + íŠ¸ë Œë“œ ë°˜ì˜)
        targets = {
            't4_5min': t4_seq[-1] + trend * 0.5,
            't4_10min': t4_seq[-1] + trend * 1.0,
            # ...
        }
        training_data.append((sequence, targets))
    
    # Temperature Predictor í•™ìŠµ
    self.temp_predictor.train(training_data)
    # Random Forest Optimizer í•™ìŠµ
    self.rf_optimizer.train(training_data)
```

**ì´ˆê¸°í™” ì‹œ ë™ì‘:**
```python
# IntegratedController.__init__()
try:
    # ê¸°ì¡´ ëª¨ë¸ ë¡œë“œ ì‹œë„
    self.temp_predictor.load_models('models/')
    self.rf_optimizer.load_models('models/')
except:
    # ëª¨ë¸ ì—†ìœ¼ë©´ ë”ë¯¸ í•™ìŠµ!
    print("[INFO] ê¸°ì¡´ ëª¨ë¸ ì—†ìŒ â†’ ë”ë¯¸ ëª¨ë¸ í•™ìŠµ")
    self._train_dummy_model()
```

**í•µì‹¬ í¬ì¸íŠ¸:**
- ì‹¤ì„  ë°°í¬ ì´ˆê¸°ì—ë„ ML í¬ë˜ì‹œ ì—†ìŒ
- ë”ë¯¸ ëª¨ë¸ë¡œ ìµœì†Œí•œì˜ ì˜ˆì¸¡ ê¸°ëŠ¥ ì œê³µ
- ì‹¤ì œ ë°ì´í„° ìˆ˜ì§‘ë˜ë©´ Batch Learningìœ¼ë¡œ ì •ë°€ í•™ìŠµ

---

## ğŸŒŠ ML ë¶ˆì•ˆì • ì‹œ ì œì–´ íë¦„

### ì‹œë‚˜ë¦¬ì˜¤ 1: ì´ˆê¸° ìš´ì˜ (ì‹¤ ë°ì´í„° ë¶€ì¡±)

```
[ìƒí™©] ì„ ë°• ì·¨í•­ ì²«ë‚ , ML í•™ìŠµ ë°ì´í„° ì—†ìŒ

1. ì‹œìŠ¤í…œ ë¶€íŒ…
   â”œâ”€ IntegratedController ì´ˆê¸°í™”
   â”œâ”€ ê¸°ì¡´ ëª¨ë¸ ì°¾ê¸° ì‹¤íŒ¨
   â””â”€ _train_dummy_model() ìë™ ì‹¤í–‰
       â””â”€ 50ê°œ ë”ë¯¸ ë°ì´í„°ë¡œ ìµœì†Œ ML í•™ìŠµ

2. ìš´ì „ ì‹œì‘
   â”œâ”€ ML ì˜ˆì¸¡ ì‹œë„ (ë”ë¯¸ ëª¨ë¸ ì‚¬ìš©)
   â”‚   â””â”€ confidence = ~0.3-0.4 (ë‚®ìŒ!)
   â”œâ”€ confidence < 0.5 â†’ ML ì‚¬ìš© ì•ˆ í•¨!
   â””â”€ Rule ê¸°ë°˜ ì œì–´ë¡œ ì „í™˜
       â”œâ”€ Safety Layer: ì˜¨ë„ í•œê³„ ê°ì‹œ
       â””â”€ Fine-tuning Layer: í˜„ì¬ ì˜¨ë„ ê¸°ë°˜ ì¡°ì •

3. ì œì–´ ê²°ê³¼
   âœ… T5 > 40Â°C â†’ Safety S4: ê°•ì œ 60Hz
   âœ… T4 < 46Â°C â†’ Safety S6: ê°•ì œ 40Hz (ì—ë„ˆì§€ ì ˆê°)
   âœ… T6 > 45Â°C â†’ Safety S5: ê°•ì œ 60Hz
   âœ… ML ì—†ì–´ë„ ì•ˆì „í•˜ê³  íš¨ìœ¨ì !
```

---

### ì‹œë‚˜ë¦¬ì˜¤ 2: ML ì‹ ë¢°ë„ ë¶€ì¡± (í•™ìŠµ ì´ˆê¸°)

```
[ìƒí™©] ìš´ì˜ 1ì£¼ì°¨, ë°ì´í„°ëŠ” ëª¨ìœ¼ê³  ìˆì§€ë§Œ ì•„ì§ ì¶©ë¶„í•˜ì§€ ì•ŠìŒ

1. Batch Learning (ìˆ˜ìš”ì¼ ìƒˆë²½ 2ì‹œ)
   â”œâ”€ ìˆ˜ì§‘ëœ ë°ì´í„°: 200ê°œ (ìµœì†Œ ìš”êµ¬: 100ê°œ)
   â”œâ”€ ì´ìƒì¹˜ ì œê±° (outlier detection)
   â””â”€ ML ëª¨ë¸ ì—…ë°ì´íŠ¸ ì™„ë£Œ

2. ìš´ì „ ì¤‘ ML ì˜ˆì¸¡
   â”œâ”€ ML ì˜ˆì¸¡ ì„±ê³µ
   â”‚   â””â”€ confidence = ~0.45 (ì•„ì§ ë‚®ìŒ!)
   â”œâ”€ confidence < 0.5 â†’ ML ì‚¬ìš© ì•ˆ í•¨!
   â””â”€ Rule ê¸°ë°˜ ì œì–´ ê³„ì†

3. ì œì–´ ê²°ê³¼
   âœ… MLì´ ì˜ˆì¸¡ì€ í•˜ì§€ë§Œ ì‹ ë¢°ë„ ë¶€ì¡±ìœ¼ë¡œ ì ìš© ì•ˆ í•¨
   âœ… Safety Layer + Rule Fine-tuningìœ¼ë¡œ ì•ˆì „ ìš´ì „
   âœ… ë°ì´í„°ëŠ” ê³„ì† ìˆ˜ì§‘ ì¤‘ (ë‹¤ìŒ í•™ìŠµ ëŒ€ë¹„)
```

---

### ì‹œë‚˜ë¦¬ì˜¤ 3: ML ì•ˆì •í™” (ìš´ì˜ 2ì£¼ í›„)

```
[ìƒí™©] ìš´ì˜ 2ì£¼ì°¨, ë°ì´í„° ì¶©ë¶„íˆ ì¶•ì ë¨

1. Batch Learning (ì¼ìš”ì¼ ìƒˆë²½ 2ì‹œ, 2ì°¨ í•™ìŠµ)
   â”œâ”€ ìˆ˜ì§‘ëœ ë°ì´í„°: 1,500ê°œ
   â”œâ”€ ë‹¤ì–‘í•œ í•´ì—­/ë¶€í•˜ íŒ¨í„´ í•™ìŠµ
   â””â”€ ML ëª¨ë¸ ì •ë°€ ì—…ë°ì´íŠ¸

2. ìš´ì „ ì¤‘ ML ì˜ˆì¸¡
   â”œâ”€ ML ì˜ˆì¸¡ ì„±ê³µ
   â”‚   â””â”€ confidence = ~0.75 (ë†’ìŒ!)
   â”œâ”€ confidence > 0.5 â†’ ML ì‚¬ìš©!
   â””â”€ ML Optimization Layer í™œì„±í™”
       â”œâ”€ ì˜¨ë„ ìƒìŠ¹ ì˜ˆì¸¡ â†’ ì„ ì œì  ì¦ì†
       â””â”€ ì˜¨ë„ í•˜ê°• ì˜ˆì¸¡ â†’ ì„ ì œì  ê°ì†

3. ì œì–´ ê²°ê³¼ (ML + Rule í˜‘ì—…)
   âœ… Safety Layer: ì—¬ì „íˆ ìµœìš°ì„  ê°ì‹œ
   âœ… ML Layer: ì„ ì œì  ì˜¨ë„ ì˜ˆì¸¡ ì œì–´
   âœ… Fine-tuning Layer: Ruleë¡œ ë¯¸ì„¸ ë³´ì •
   âœ… ìµœì  ì—ë„ˆì§€ ì ˆê° ë‹¬ì„±!
```

---

## ğŸ”„ ML ë¶ˆì•ˆì • ì‹œ Rule ê¸°ë°˜ ì œì–´ ìƒì„¸

### T5 ì œì–´ (SW Pump) - ML ì—†ì„ ë•Œ

```python
# Safety Layer S4 (ê·¹í•œ ì˜¨ë„ë§Œ)
if t5_temp > 40.0:
    sw_freq = 60.0  # ê·¹ê³ ì˜¨ â†’ 60Hz ê°•ì œ
elif t5_temp < 30.0:
    sw_freq = 40.0  # ê·¹ì €ì˜¨ â†’ 40Hz ê°•ì œ
else:
    # ì •ìƒ ë²”ìœ„ (30-40Â°C) â†’ MLì—ê²Œ ìœ„ì„
    pass  # ml_prediction ì‚¬ìš© (ìˆìœ¼ë©´)

# Fine-tuning Layer R1 (í˜„ì¬ ì˜¨ë„ ê¸°ë°˜ ë³´ì •)
# MLì´ Noneì´ë©´ prev_sw_freq ê¸°ì¤€ìœ¼ë¡œ ì‘ë™
if t5_temp > 38.0:
    sw_freq += min(6.0, (t5_temp - 38.0) * 3.0)  # 60Hz ìˆ˜ë ´
elif t5_temp < 32.0:
    sw_freq -= min(6.0, (32.0 - t5_temp) * 3.0)  # 40Hz ìˆ˜ë ´
```

**ML ì—†ì„ ë•Œ ë™ì‘:**
- T5 > 40Â°C: Safety Layerê°€ 60Hz ê°•ì œ â†’ ì•ˆì „!
- 38Â°C < T5 < 40Â°C: R1ì´ ì ì§„ì  ì¦ì† â†’ 38Â°Cì—ì„œ ì‹œì‘í•´ 60Hzë¡œ ìˆ˜ë ´
- 30Â°C < T5 < 32Â°C: R1ì´ ì ì§„ì  ê°ì† â†’ 32Â°Cì—ì„œ ì‹œì‘í•´ 40Hzë¡œ ìˆ˜ë ´
- T5 < 30Â°C: Safety Layerê°€ 40Hz ê°•ì œ â†’ ì•ˆì „!

**ê²°ê³¼:** ML ì—†ì–´ë„ ì˜¨ë„ ì œì–´ ì™„ë²½íˆ ì‘ë™!

---

### T4 ì œì–´ (FW Pump) - ML ì—†ì„ ë•Œ

```python
# Safety Layer S2 (ê¸´ê¸‰ ê³ ì˜¨)
if t4_temp >= 48.0:
    fw_freq = 60.0  # 48Â°C ì´ˆê³¼ â†’ 60Hz ê°•ì œ!
    safety_override = True
    return RuleDecision(...)

# Safety Layer S6 (ì—ë„ˆì§€ ì ˆê° ëª¨ë“œ)
if t4_temp < 46.0:
    # Phase 1: ë¬´ì¡°ê±´ 40Hz (ì—ë„ˆì§€ ì ˆê°)
    if prev_fw_freq > 40.5:
        fw_freq = max(40.0, prev_fw_freq - 3.0)  # ì ì§„ ê°ì†
    else:
        fw_freq = 40.0  # 40Hz ìœ ì§€
    safety_override = True
    return RuleDecision(...)

elif 46.0 <= t4_temp < 47.0:
    # Phase 1-2: 42Hz (ì•ˆì „ ë§ˆì§„)
    fw_freq = 42.0
    safety_override = True
    return RuleDecision(...)

elif 47.0 <= t4_temp < 48.0:
    # Phase 1-3: 46Hz (ëŒ€ê¸°)
    fw_freq = 46.0
    safety_override = True
    return RuleDecision(...)
```

**ML ì—†ì„ ë•Œ ë™ì‘:**
- T4 â‰¥ 48Â°C: Safety S2ê°€ 60Hz ê°•ì œ â†’ ê¸´ê¸‰ ëƒ‰ê°!
- 47Â°C â‰¤ T4 < 48Â°C: Safety S6ê°€ 46Hz ê°•ì œ â†’ ëŒ€ê¸°
- 46Â°C â‰¤ T4 < 47Â°C: Safety S6ê°€ 42Hz ê°•ì œ â†’ ì•ˆì „ ë§ˆì§„
- T4 < 46Â°C: Safety S6ê°€ 40Hz ê°•ì œ â†’ ìµœëŒ€ ì—ë„ˆì§€ ì ˆê°!

**ê²°ê³¼:** ML ì—†ì–´ë„ T4 ì œì–´ + ì—ë„ˆì§€ ì ˆê° ë™ì‹œ ë‹¬ì„±!

---

### T6 ì œì–´ (E/R Fan) - ML ì—†ì„ ë•Œ

```python
# Safety Layer S5 (T6 ì˜¨ë„ ì œì–´)
if t6_temp > 45.0:
    er_freq = 60.0  # ê¸´ê¸‰ ê³ ì˜¨ â†’ 60Hz
    safety_override = True
    return RuleDecision(...)

elif 44.0 < t6_temp <= 45.0:
    er_freq = 60.0  # ê³ ì˜¨ â†’ 60Hz ìœ ì§€
    safety_override = True
    return RuleDecision(...)

elif 42.0 <= t6_temp <= 44.0:
    # ì •ìƒ êµ¬ê°„ â†’ 48Hz ìˆ˜ë ´
    if abs(prev_er_freq - 48.0) > 0.5:
        if prev_er_freq > 48.0:
            er_freq = max(48.0, prev_er_freq - 2.0)  # ê°ì†
        else:
            er_freq = min(48.0, prev_er_freq + 2.0)  # ì¦ì†
    else:
        er_freq = 48.0  # 48Hz ìœ ì§€ (ML ê°€ëŠ¥)
        safety_override = False  # ML í—ˆìš©!

elif t6_temp < 42.0:
    # ì €ì˜¨ â†’ 40Hzë¡œ ê°ì†
    if prev_er_freq > 40.5:
        er_freq = max(40.0, prev_er_freq - 2.0)  # ì ì§„ ê°ì†
    else:
        er_freq = 40.0  # 40Hz ìœ ì§€
        safety_override = False  # ëŒ€ìˆ˜ ì œì–´ í—ˆìš©
```

**ML ì—†ì„ ë•Œ ë™ì‘:**
- T6 > 45Â°C: 60Hz ê°•ì œ â†’ ê¸´ê¸‰ ëƒ‰ê°
- 44-45Â°C: 60Hz ìœ ì§€ â†’ ê³ ì˜¨ ì œì–´
- 42-44Â°C: 48Hzë¡œ ìˆ˜ë ´ â†’ ì •ìƒ ìš´ì „
- T6 < 42Â°C: 40Hzë¡œ ìˆ˜ë ´ â†’ ì—ë„ˆì§€ ì ˆê°

**ê²°ê³¼:** ML ì—†ì–´ë„ T6 ì œì–´ + ëŒ€ìˆ˜ ì œì–´ ëª¨ë‘ ì‘ë™!

---

## âœ… ê²°ë¡ : ML ë¶ˆì•ˆì •í•´ë„ ì•ˆì „í•œ ì´ìœ 

### 1. ë‹¤ì¤‘ ì•ˆì „ë§ (Triple Safety Net)

```
[ì˜¨ë„ > ìœ„í—˜ ìˆ˜ì¤€]
    â””â”€> Safety Layerê°€ ì¦‰ì‹œ ê°•ì œ ì œì–´ (ML ë¬´ì‹œ)
        â””â”€> 100% Rule ê¸°ë°˜ â†’ ì ˆëŒ€ ì•ˆì „!

[ML ì‹ ë¢°ë„ < 50%]
    â””â”€> ML ì‚¬ìš© ì•ˆ í•¨
        â””â”€> Rule Fine-tuningìœ¼ë¡œ ì œì–´

[ML ì˜ˆì¸¡ ì‹¤íŒ¨/í¬ë˜ì‹œ]
    â””â”€> Exception ì²˜ë¦¬ â†’ ml_prediction = None
        â””â”€> Rule ê¸°ë°˜ ì œì–´ë¡œ ìë™ ì „í™˜

[ì´ˆê¸° ëª¨ë¸ ì—†ìŒ]
    â””â”€> Dummy Model ìë™ í•™ìŠµ
        â””â”€> ìµœì†Œ ê¸°ëŠ¥ ë³´ì¥ (í¬ë˜ì‹œ ë°©ì§€)
```

---

### 2. Rule ê¸°ë°˜ ì œì–´ë§Œìœ¼ë¡œë„ ì¶©ë¶„

| ì œì–´ í•­ëª© | ML ì—†ì„ ë•Œ ë™ì‘ | ì•ˆì „ì„± |
|---------|----------------|--------|
| **T5 (SW Pump)** | Safety S4 + Rule R1ë¡œ 30-40Â°C ì œì–´ | âœ… ì™„ë²½ |
| **T4 (FW Pump)** | Safety S6ë¡œ 3ë‹¨ê³„ ì œì–´ (40-46-48Â°C) | âœ… ì™„ë²½ |
| **T6 (E/R Fan)** | Safety S5ë¡œ ë‹¨ê³„ë³„ ì œì–´ (40-48-60Hz) | âœ… ì™„ë²½ |
| **ì••ë ¥ (PX1)** | Safety S3ë¡œ ì••ë ¥ í•œê³„ ê°ì‹œ | âœ… ì™„ë²½ |
| **ê³¼ì—´ ë³´í˜¸** | Safety S1, S2ë¡œ ê°•ì œ ëƒ‰ê° | âœ… ì™„ë²½ |

---

### 3. MLì˜ ì—­í• : "ì„±ëŠ¥ í–¥ìƒ" (í•„ìˆ˜ ì•„ë‹˜)

```
[Rule ê¸°ë°˜ë§Œ]
    â”œâ”€ ì•ˆì „: âœ… ì™„ë²½ ë³´ì¥
    â”œâ”€ ì˜¨ë„ ì œì–´: âœ… ì •ìƒ ë²”ìœ„ ìœ ì§€
    â”œâ”€ ì—ë„ˆì§€ ì ˆê°: âœ… ê¸°ë³¸ ìˆ˜ì¤€ ë‹¬ì„±
    â””â”€ ë°˜ì‘ ì†ë„: ğŸŸ¡ í˜„ì¬ ì˜¨ë„ ê¸°ë°˜ (í›„í–‰ì )

[Rule + ML í˜‘ì—…] (ML ì•ˆì •í™” í›„)
    â”œâ”€ ì•ˆì „: âœ… ì™„ë²½ ë³´ì¥ (Safety Layer ìœ ì§€)
    â”œâ”€ ì˜¨ë„ ì œì–´: âœ… ì •ìƒ ë²”ìœ„ ìœ ì§€
    â”œâ”€ ì—ë„ˆì§€ ì ˆê°: â­ ìµœì í™”! (ì„ ì œ ëŒ€ì‘)
    â””â”€ ë°˜ì‘ ì†ë„: â­ ì˜ˆì¸¡ ê¸°ë°˜ (ì„ í–‰ì )

â†’ MLì€ "ìˆìœ¼ë©´ ì¢‹ì€" ì„±ëŠ¥ ë¶€ìŠ¤í„°!
â†’ ì—†ì–´ë„ ì‹œìŠ¤í…œì€ ì™„ë²½íˆ ì•ˆì „í•˜ê³  íš¨ìœ¨ì !
```

---

## ğŸš€ ì‹¤ì„  ìš´ì˜ ì‹œ ë‹¨ê³„ë³„ ì§„í™”

### Week 1-2: Rule ê¸°ë°˜ ìš´ì „ (ML ë¹„í™œì„±)
- Safety Layerë§Œìœ¼ë¡œ ì•ˆì „ ìš´ì „
- ë°ì´í„° ìˆ˜ì§‘ ì¤‘ (500-1000ê°œ)
- ML ì˜ˆì¸¡ì€ í•˜ì§€ë§Œ ì‹ ë¢°ë„ ë‚®ì•„ì„œ ë¯¸ì ìš©

### Week 3-4: ML í™œì„±í™” ì‹œì‘
- Batch Learning 2-3íšŒ ì™„ë£Œ
- ML ì‹ ë¢°ë„ 50% ëŒíŒŒ
- ML + Rule í˜‘ì—… ì œì–´ ì‹œì‘

### Month 2+: ML ìµœì í™” ìš´ì „
- ë‹¤ì–‘í•œ í•´ì—­/ë¶€í•˜ ë°ì´í„° í•™ìŠµ
- ML ì‹ ë¢°ë„ 70-80% ì•ˆì •í™”
- ìµœëŒ€ ì—ë„ˆì§€ ì ˆê° ë‹¬ì„±

---

## ğŸ“Š ì•ˆì „ì„± ë¹„êµ

| í•­ëª© | PID ì œì–´ | Rule + ML (í˜„ì¬) |
|------|----------|------------------|
| **ì´ˆê¸° ì•ˆì •ì„±** | ğŸ”´ íŠœë‹ í•„ìš” | âœ… ì¦‰ì‹œ ì•ˆì „ |
| **ML ì—†ì„ ë•Œ** | âŒ ë¶ˆê°€ëŠ¥ | âœ… Ruleë¡œ ì‘ë™ |
| **ML ì‹¤íŒ¨ ì‹œ** | âŒ í¬ë˜ì‹œ | âœ… ìë™ Fallback |
| **ë‹¤ì¤‘ ì•ˆì „ë§** | ğŸŸ¡ Single | âœ… Triple Layer |
| **íˆ¬ëª…ì„±** | ğŸ”´ ë¶ˆíˆ¬ëª… | âœ… ê·œì¹™ ëª…í™• |
| **ìœ ì§€ë³´ìˆ˜** | ğŸ”´ ì–´ë ¤ì›€ | âœ… ì‰¬ì›€ |

---

## ğŸ’¡ í•µì‹¬ ìš”ì•½

1. **Safety Layerê°€ ì ˆëŒ€ ìµœìš°ì„ **
   - `safety_override = True`ë©´ ML ì™„ì „ ë¬´ì‹œ
   - ì˜¨ë„ í•œê³„ ì‹œ ê°•ì œ ì œì–´

2. **ML ì‹ ë¢°ë„ ê²€ì¦**
   - confidence < 0.5ì´ë©´ ML ì‚¬ìš© ì•ˆ í•¨
   - Rule ê¸°ë°˜ ì œì–´ë¡œ ìë™ ì „í™˜

3. **ML ì‹¤íŒ¨ ì‹œ Fallback**
   - Exception ì²˜ë¦¬ë¡œ í¬ë˜ì‹œ ë°©ì§€
   - `ml_prediction = None`ìœ¼ë¡œ Rule ì „í™˜

4. **Dummy Modelë¡œ ì´ˆê¸° ì•ˆì •ì„±**
   - ì‹¤ì„  ë°°í¬ ì²«ë‚ ë¶€í„° ML ê¸°ëŠ¥ ì‘ë™
   - í¬ë˜ì‹œ ì—†ëŠ” ì•ˆì •ì  ìš´ì˜

5. **Ruleë§Œìœ¼ë¡œë„ ì™„ë²½í•œ ì œì–´**
   - MLì€ "ì„±ëŠ¥ í–¥ìƒ" ì—­í• 
   - ì—†ì–´ë„ ì•ˆì „í•˜ê³  íš¨ìœ¨ì !

---

**ê²°ë¡ : ì´ ì‹œìŠ¤í…œì€ MLì´ ë¶ˆì•ˆì •í•´ë„ Rule ê¸°ë°˜ ì œì–´ë¡œ ì™„ë²½íˆ ì•ˆì „í•˜ê²Œ ìš´ì˜ë©ë‹ˆë‹¤!** âœ…


